)]}'
{"version":3,"file":"/packages/paginator.js","sources":["paginator/lib/client/meteor.paginator.js","paginator/lib/client/paginationTemplates.html"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,oC;;AAEA,a;AACA,c;AACA,sB;AACA,G;AACA,iB;AACA,iB;AACA,sB;AACA,oB;AACA,kB;AACA,G;AACA,gB;AACA,0B;AACA,2C;AACA,0B;AACA,wB;AACA,6B;AACA,4B;AACA,8B;AACA,kC;AACA,G;AACA,G;;AAEA,uB;;AAEA,iB;AACA,2B;AACA,uE;AACA,+D;AACA,4D;;AAEA,iC;AACA,mD;AACA,iK;AACA,kC;AACA,e;AACA,qB;AACA,U;AACA,e;AACA,qB;AACA,U;AACA,gB;AACA,uB;AACA,U;AACA,e;AACA,oD;AACA,U;AACA,W;AACA,0F;AACA,U;AACA,G;AACA,E;AACA,uD;AACA,mD;AACA,yG;AACA,wF;AACA,oB;AACA,mB;AACA,G;AACA,G;;AAEA,kC;AACA,sG;AACA,uE;;AAEA,6D;AACA,U;;AAEA,0C;AACA,gG;AACA,8F;AACA,4C;AACA,oC;AACA,O;AACA,U;AACA,uD;AACA,oC;AACA,O;AACA,M;AACA,E;AACA,oE;AACA,yC;AACA,G;;AAEA,c;AACA,yB;AACA,gD;AACA,sC;AACA,oB;AACA,K;AACA,G;;AAEA,0C;AACA,kC;AACA,gD;AACA,gD;AACA,sC;AACA,oB;AACA,2G;AACA,K;AACA,G;;AAEA,uB;AACA,wD;AACA,mD;AACA,mF;AACA,mG;AACA,sB;AACA,sC;AACA,2E;AACA,e;AACA,O;AACA,a;AACA,G;;AAEA,kE;AACA,kK;AACA,G;;AAEA,8D;AACA,2D;AACA,G;;AAEA,0D;AACA,6E;AACA,0B;AACA,8C;AACA,wC;AACA,iB;AACA,wB;AACA,G;;AAEA,oB;AACA,yD;;AAEA,sC;AACA,e;;AAEA,mE;;AAEA,iD;;AAEA,6B;AACA,sE;AACA,gF;AACA,uC;AACA,uC;AACA,2F;AACA,kC;AACA,M;;AAEA,mE;AACA,4E;AACA,yF;AACA,4C;AACA,yB;AACA,K;AACA,M;AACA,G;AACA,mB;;AAEA,sG;;AAEA,8E;;AAEA,U;AACA,G;;AAEA,2B;AACA,0F;AACA,kE;AACA,yE;AACA,iE;AACA,iE;AACA,iD;AACA,iE;AACA,kE;AACA,G;AACA,6F;AACA,G;;AAEA,sB;AACA,uC;AACA,wC;AACA,mD;AACA,oB;AACA,U;AACA,I;;AAEA,c;AACA,E;;;;;;;;;;;;;;;;;;AC/LA,wjC;AACA,+Y","sourcesContent":["Meteor.Paginator = function(_opts) {\n\n\tvar opts = {\n\t\ttemplates: {\n\t        content: null\n\t\t}\n\t\t, pagination: {\n\t\t\tcurrentPage: 0\n\t\t\t, resultsPerPage: 5\n\t\t\t, totalRecords: 0\n\t\t\t, totalPages: 0\n\t\t}\n\t\t, callbacks: {\n\t\t\tonPagingCompleted: null\n\t\t\t, getDependentSubscriptionsHandles: null\n\t\t\t, getTotalRecords: null\n\t\t\t, onDataLoading: null\n\t\t\t, onTemplateRendered: null\n\t\t\t, onTemplateCreated: null\n\t\t\t, onTemplateDestroyed: null\n\t\t\t, onResultsPerPageChanged: null\n\t\t}\n\t};\n\n\t_.extend(opts, _opts);\n\n\tvar _self = this\n\t\t, _instance = Random.id()\n\t\t, _sessionMultiplePages = opts.templates.content+'__hasMultiplePages'\n\t\t, _sessionButtons = opts.templates.content+\"__sessionButtons\"\n\t\t, _sessionRPP = opts.templates.content+\"__resultsPerPage\";\n\n\tvar _setPaging = function(ele) {\n\t\tvar _scheduledPage = opts.pagination.currentPage;\n\t\t$(\".pageButton[data-instance-id='\" + ele.attr(\"data-instance-id\") + \"']\").each(function() { $(this).parent().removeClass(\"active\").removeClass(\"disabled\"); });\n\t\tswitch (ele.attr(\"data-page\")) {\n\t\t\tcase \"next\":\n\t\t\t\t_scheduledPage++;\n\t\t\t\tbreak;\n\t\t\tcase \"back\":\n\t\t\t\t_scheduledPage--;\n\t\t\t\tbreak;\n\t\t\tcase \"first\":\n\t\t\t\t_scheduledPage = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"last\":\n\t\t\t\t_scheduledPage = opts.pagination.totalPages - 1;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t_scheduledPage = parseInt(ele.attr(\"data-page\")) || 0; //zero if pagination is missing\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t\tif (opts.pagination.currentPage !== _scheduledPage) {\n    \t\topts.pagination.currentPage = _scheduledPage;\n    \t\tvar skip = _scheduledPage * opts.pagination.resultsPerPage, limit = opts.pagination.resultsPerPage;\n    \t\topts.callbacks.onPagingCompleted && opts.callbacks.onPagingCompleted(skip, limit);\n\t\t\t_setPagination();\n\t\t\t_setBtnStyles();\n\t\t}\n\t};\n\n\tvar _setPagination = function() {\n\t\topts.pagination.totalPages = Math.ceil(opts.pagination.totalRecords/opts.pagination.resultsPerPage);\n\t\tvar _btns = [], _max = Math.min(parseInt($(window).width()/140), 10);\n\n\t\twhile (_max % 2 !== 0 && _max < opts.pagination.totalPages)\n\t\t\t_max++;\n\n\t\tif (opts.pagination.totalPages > _max) {\n\t\t\tvar _start = opts.pagination.currentPage > _max/2 ? opts.pagination.currentPage - _max/2 : 0;\n\t\t\tif (_start > opts.pagination.totalPages - _max) _start = opts.pagination.totalPages - _max;\n\t\t\tfor(p = _start; p < _start + _max; p++) {\n\t    \t\t_btns.push({r: p, p: p + 1});\n\t    \t}\n\t\t} else {\n\t    \tfor(p = 0; p < opts.pagination.totalPages; p++) {\n\t    \t\t_btns.push({r: p, p: p + 1});\n\t    \t}\n    \t}\n\t\t\n    \tSession.set(_sessionMultiplePages, opts.pagination.totalPages);\n    \tSession.set(_sessionButtons, _btns);\n\t};\n\n\tvar _resizer;\n\tvar _init = function() {\n\t\topts.callbacks.getTotalRecords(function(tot) {\n\t\t\topts.pagination.totalRecords = tot;\n\t\t\t_setPagination();\n\t\t});\n\t};\n\n\t_self.refreshPagination = function(rpp) {\n\t\topts.pagination.currentPage = 0;\n\t\tif (rpp) opts.pagination.resultsPerPage = rpp;\n\t\topts.callbacks.getTotalRecords(function(tot) {\n\t\t\topts.pagination.totalRecords = tot;\n\t\t\t_setPagination();\n\t\t\topts.callbacks.onPagingCompleted && opts.callbacks.onPagingCompleted(0, opts.pagination.resultsPerPage);\n\t\t});\n\t};\n\n\tvar _subWatchers = [];\n\tTemplate[opts.templates.content].created = function() {\n    \tvar _autorun = window.setInterval(function() {\n\t\t\tvar _dependentSubscriptions = opts.callbacks.getDependentSubscriptionsHandles();\n    \t\tvar _allReady = _.every(_dependentSubscriptions, function(s) { return s.ready() === true; });\n\t    \tif (_allReady) {\n    \t\t\twindow.clearInterval(_autorun);\n\t\t\t\topts.callbacks.onTemplateCreated && opts.callbacks.onTemplateCreated();\n\t    \t\t_init();\n\t    \t}\n\t    }, 250);\n\t};\n\n\tTemplate[opts.templates.content].paginationButtons = function() {\n\t\treturn Template.pagination_buttons({ instance: _instance, hasMultiplePages: Session.get(_sessionMultiplePages) > 1, pageButton: Session.get(_sessionButtons) });\n\t};\n\n\tTemplate[opts.templates.content].selectPerPage = function() {\n\t\treturn Template.select_per_page({ instance: _instance });\n\t};\n\n\tTemplate[opts.templates.content].destroyed = function() {\n\t\topts.callbacks.onTemplateDestroyed && opts.callbacks.onTemplateDestroyed();\n\t\tsetTimeout(function() {\t\n\t\t\tdelete Session.keys[_sessionMultiplePages];\n\t\t\tdelete Session.keys[_sessionButtons];\n\t\t\tdelete _self; \n\t\t}, 0); //self destruct\n\t};\n\n\tvar _doneRendering;\n\tTemplate[opts.templates.content].rendered = function() {\n\n\t\twindow.clearTimeout(_doneRendering);\n\t\tvar s = this;\n\n\t\topts.callbacks.onDataLoading &&  opts.callbacks.onDataLoading(s);\n\n\t\t_doneRendering = window.setTimeout(function() {\n\n\t\t\t//do all the event binding\n\t\t\t$(\"#selectPerPage[data-instance-id='\" + _instance + \"']\").unbind();\n\t\t\t$(\"#selectPerPage[data-instance-id='\" + _instance + \"']\").change(function() {\n\t\t\t\tvar _rpp = parseInt($(this).val());\n\t\t\t\tconsole.log(\"changing rpp \", _rpp);\n\t\t\t\topts.callbacks.onResultsPerPageChanged && opts.callbacks.onResultsPerPageChanged(_rpp);\n\t\t\t\t_self.refreshPagination(_rpp);\n\t\t\t});\n\n\t\t\t$(\".pageButton[data-instance-id='\" + _instance + \"']\").unbind();\n\t\t\t$(\".pageButton[data-instance-id='\" + _instance + \"']\").click(function() {\n\t\t\t\tif (!$(this).parent().hasClass(\"disabled\") && !$(this).parent().hasClass(\"active\")) {\n\t\t\t\t\tconsole.log(\"changing page \", $(this));\n\t\t\t\t\t_setPaging($(this));\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t_setBtnStyles();\n\n\t\t\t$(\"#selectPerPage[data-instance-id='\" + _instance + \"']\").val(opts.pagination.resultsPerPage + \"\");\n\n\t\t\topts.callbacks.onTemplateRendered &&  opts.callbacks.onTemplateRendered(s);\n\n\t\t}, 250);\n\t};\n\n\tfunction _setBtnStyles() {\n\t\tif (typeof opts.pagination.currentPage === 'undefined') opts.pagination.currentPage = 0;\n\t\tvar _base = \".pageButton[data-instance-id='\" + _instance + \"']\";\n\t\tif (opts.pagination.currentPage === (opts.pagination.totalPages - 1)) {\n\t\t\t$(_base + \"[data-page='next']\").parent().addClass(\"disabled\");\n\t\t\t$(_base + \"[data-page='last']\").parent().addClass(\"disabled\");\n\t\t} else if (opts.pagination.currentPage === 0) {\n\t\t\t$(_base + \"[data-page='back']\").parent().addClass(\"disabled\");\n\t\t\t$(_base + \"[data-page='first']\").parent().addClass(\"disabled\");\n\t\t}\n\t\t$(_base + \"[data-page='\" + opts.pagination.currentPage + \"']\").parent().addClass(\"active\");\n\t};\n\n\tvar _resetPagination;\n\t$(window).bind(\"resize\", function(e) {\n\t\twindow.clearTimeout(_resetPagination);\n\t\t_resetPagination = window.setTimeout(function() {\n\t\t\t_setPagination();\n\t\t}, 250);\n\t});\n\n\treturn _self;\n};","Template.__define__(\"pagination_buttons\",Package.handlebars.Handlebars.json_ast_to_func([[\"#\",[[0,\"if\"],[0,\"hasMultiplePages\"]],[\"\\r\\n\\t\\t<div class=\\\"pagination pagination-button-container\\\">\\r\\n\\t\\t\\t<ul>\\r\\n\\t\\t\\t\\t<li><a href=\\\"javascript:\\\" data-page=\\\"first\\\" class=\\\"pageButton\\\" data-instance-id=\\\"\",[\"{\",[[0,\"instance\"]]],\"\\\">&laquo;&laquo;</a></li>\\r\\n\\t\\t\\t\\t<li><a href=\\\"javascript:\\\" data-page=\\\"back\\\" class=\\\"pageButton\\\" data-instance-id=\\\"\",[\"{\",[[0,\"instance\"]]],\"\\\">&laquo;</a></li>\\r\\n\\t\\t\\t\\t\",[\"#\",[[0,\"each\"],[0,\"pageButton\"]],[\"\\r\\n\\t\\t\\t\\t\\t<li><a href=\\\"javascript:\\\" data-page=\\\"\",[\"{\",[[0,\"r\"]]],\"\\\" class=\\\"pageButton\\\" data-instance-id=\\\"\",[\"{\",[[1,\"instance\"]]],\"\\\">\",[\"{\",[[0,\"p\"]]],\"</a></li>\\r\\n\\t\\t\\t\\t\"]],\"\\r\\n\\t\\t\\t\\t<li><a href=\\\"javascript:\\\" data-page=\\\"next\\\" class=\\\"pageButton\\\" data-instance-id=\\\"\",[\"{\",[[0,\"instance\"]]],\"\\\">&raquo;</a></li>\\r\\n\\t\\t\\t\\t<li><a href=\\\"javascript:\\\" data-page=\\\"last\\\" class=\\\"pageButton\\\" data-instance-id=\\\"\",[\"{\",[[0,\"instance\"]]],\"\\\">&raquo;&raquo;</a></li>\\r\\n\\t\\t\\t</ul>\\r\\n\\t\\t</div>\\r\\n\\t\"]]]));\nTemplate.__define__(\"select_per_page\",Package.handlebars.Handlebars.json_ast_to_func([\"<select id=\\\"selectPerPage\\\" class=\\\"input-mini\\\" style='font-size:10pt;' data-instance-id=\\\"\",[\"{\",[[0,\"instance\"]]],\"\\\">\\r\\n   \\t\\t<option value=\\\"5\\\">5</option>\\r\\n   \\t\\t<option value=\\\"10\\\">10</option>\\r\\n   \\t\\t<option value=\\\"20\\\">20</option>\\r\\n   \\t\\t<option value=\\\"30\\\">30</option>\\r\\n\\t</select>\"]));\n"]}